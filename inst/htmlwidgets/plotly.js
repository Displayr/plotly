!function r(i,o,n){function a(e,t){if(!o[e]){if(!i[e]){var l="function"==typeof require&&require;if(!t&&l)return l(e,!0);if(s)return s(e,!0);throw(l=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",l}l=o[e]={exports:{}},i[e][0].call(l.exports,function(t){return a(i[e][1][t]||t)},l,l.exports,r,i,o,n)}return o[e].exports}for(var s="function"==typeof require&&require,t=0;t<n.length;t++)a(n[t]);return a}({1:[function(t,e,l){"use strict";var r={name:"plotly",type:"output",initialize:function(t,e,l){return{}},resize:function(t,e,l,r){r.autosize&&(e=r.width||e,l=r.height||l,Plotly.relayout(t,{width:e,height:l}))},renderValue:function(n,o,t){var e=o.layout||{};t.width=e.width,t.height=e.height,t.autosize=e.autosize||!0;crosstalk.var("plotlyCrosstalkOpts").set(o.highlight);"undefined"!=typeof window&&(window.PLOTLYENV=window.PLOTLYENV||{},window.PLOTLYENV.BASE_URL=o.base_url,o.highlight.persistent||(window.onmousemove=function(t){t||window.event,t.shiftKey?(o.highlight.persistent=!0,o.highlight.persistentShift=!0):(o.highlight.persistent=!1,o.highlight.persistentShift=!1)}));var a=document.getElementById(n.id);if(HTMLWidgets.addPostRenderHandler(function(){for(var t=document.querySelectorAll(".js-plotly-plot .plotly .modebar"),e=0;e<t.length;e++)t[e].style.zIndex=1}),(o.selectize||o.highlight.dynamic)&&!t.plotly){var l,r=document.createElement("div");if(r.class="plotly-crosstalk-control-panel",r.style="display: flex; flex-wrap: wrap",o.highlight.dynamic&&(l=document.createElement("div"),(g=document.createElement("input")).id=n.id+"-colourpicker",g.placeholder="asdasd",(e=document.createElement("label")).for=g.id,e.innerHTML="Brush color&nbsp;&nbsp;",l.appendChild(e),l.appendChild(g),r.appendChild(l)),o.selectize)for(var i=Object.keys(o.selectize),s=0;s<i.length;s++){var u=document.createElement("div");u.id=i[s],u.style="width: 80%; height: 10%",u.class="form-group crosstalk-input-plotly-highlight";var h=document.createElement("label");h.for=i[s],h.innerHTML=o.selectize[i[s]].group,h.class="control-label";var c=document.createElement("div");(A=document.createElement("select")).multiple=!0,c.appendChild(A),u.appendChild(h),u.appendChild(c),r.appendChild(u)}if(a.parentElement.insertBefore(r,a),o.highlight.dynamic){var p=$("#"+g.id),g=o.highlight.color||[],d={value:g[0],showColour:"both",palette:"limited",allowedCols:g.join(" "),width:"20%",height:"10%"};p.colourpicker({changeDelay:0}),p.colourpicker("settings",d),p.colourpicker("value",d.value);for(var y=o.highlight.ctGroups||[],s=0;s<y.length;s++)crosstalk.group(y[s]).var("plotlySelectionColour").set(p.colourpicker("value"));p.on("change",function(){for(var t=0;t<y.length;t++)crosstalk.group(y[t]).var("plotlySelectionColour").set(p.colourpicker("value"))})}}function f(t){return void 0!==t&&t.hasOwnProperty("points")?t.points.map(function(t){var e={curveNumber:t.curveNumber,pointNumber:t.pointNumber,x:t.x,y:t.y};t.hasOwnProperty("z")&&(e.z=t.z),t.hasOwnProperty("customdata")&&(e.customdata=t.customdata);var l,r=document.getElementById(n.id).data[t.curveNumber];l=r._isSimpleKey?(e.key=r.key,[]):["key"];for(var i=0;i<l.length;i++){var o=r[l[i]];Array.isArray(o)&&("number"==typeof t.pointNumber?e[l[i]]=o[t.pointNumber]:Array.isArray(t.pointNumber)?e[l[i]]=o[t.pointNumber[0]][t.pointNumber[1]]:Array.isArray(t.pointNumbers)&&(e[l[i]]=t.pointNumbers.map(function(t){return o[t]})))}return e}):null}t.plotly?(Plotly.purge(a),a.data=void 0,a.layout=void 0,_=Plotly.plot(a,o)):(_=Plotly.plot(a,o),t.plotly=!0),_.then(function(){HTMLWidgets.shinyMode&&Shiny.addCustomMessageHandler("plotly-calls",function(t){var e=document.getElementById(t.id);if(!e)throw new Error("Couldn't find plotly graph with id: "+t.id);if("reconfig"!=t.method){if(!Plotly[t.method])throw new Error("Unknown method "+t.method);var l=[e].concat(t.args);Plotly[t.method].apply(null,l)}else Plotly.react(e,e.data,e.layout,t.args)});for(var t=a._fullLayout._subplots.mapbox||[],e=0;e<t.length;e++){var l=t[e],r=(o.layout[l]||{})._fitBounds||{};r&&a._fullLayout[l]._subplot.map.fitBounds(r.bounds,r.options)}});var v,m,_=function(t){var e=t.data[t.curveNumber];if(!e.legendgroup)return e;var l=t.data.map(function(t){return t.legendgroup}),r=[];for(s=0;s<l.length;s++)l[s]==e.legendgroup&&r.push(t.data[s]);return r};HTMLWidgets.shinyMode&&Shiny.setInputValue&&(v={plotly_deselect:["plotly_selected","plotly_selecting","plotly_brushed","plotly_brushing","plotly_click"],plotly_unhover:["plotly_hover"],plotly_doubleclick:["plotly_click"]},Object.keys(v).map(function(t){a.on(t,function(){v[t].map(function(t){Shiny.setInputValue(t+"-"+o.source,null,{priority:"event"})})})}),m={plotly_click:f,plotly_sunburstclick:f,plotly_hover:f,plotly_unhover:f,plotly_selected:function(t){if(t)return f(t)},plotly_selecting:function(t){if(t)return f(t)},plotly_brushed:function(t){if(t)return t.range||t.lassoPoints},plotly_brushing:function(t){if(t)return t.range||t.lassoPoints},plotly_legendclick:_,plotly_legenddoubleclick:_,plotly_clickannotation:function(t){return t.fullAnnotation}},(o.shinyEvents||[]).map(function(e){var l=m[e]||function(t){return t||n.id};a.on("plotly_brushed"==e?"plotly_selected":"plotly_brushing"==e?"plotly_selecting":e,function(t){Shiny.setInputValue(e+"-"+o.source,JSON.stringify(l(t)),{priority:"event"})})})),o.highlight.color=o.highlight.color||[],Array.isArray(o.highlight.color)||(o.highlight.color=[o.highlight.color]);for(var k=new D(a,o.highlight),b=[],S=0;S<o.data.length;S++){var w=o.data[S].set;w&&-1===b.indexOf(w)&&b.push(w)}for(s=0;s<b.length;s++){var O=b[s],x=new crosstalk.SelectionHandle(O);new crosstalk.FilterHandle(O).on("change",function(t){C(n),k.updateFilter(O,t.value)});x.on("change",function(t){"plotly_selected"===o.highlight.on&&o.highlight.persistentShift&&(Array.prototype.diff=function(e){return this.filter(function(t){return e.indexOf(t)<0})},t.value=t.value.diff(t.oldValue));var e=crosstalk.var("plotlySelectionHistory").get()||[],l={receiverID:k.gd.id,plotlySelectionColour:crosstalk.group(O).var("plotlySelectionColour").get()};if(l[O]=t.value,0<e.length)for(var r=JSON.stringify(l),i=0;i<e.length;i++)if(JSON.stringify(e[i])==r)return;o.highlight.persistent?e.push(l):e=[l],crosstalk.var("plotlySelectionHistory").set(e),k.updateSelection(O,t.value),o.selectize&&(o.highlight.persistent&&null!==t.value||E.clear(!0),E.addItems(t.value,!0),E.close())});var N,A,E,P=function(t){if(t){var e,l=function(t){for(var e={},l=0;l<t.length;l++){var r,i=a.data[t[l].curveNumber];i.key&&i.set&&(e[i.set]=e[i.set]||{value:[],_isSimpleKey:i._isSimpleKey},r="number"==typeof(r=t[l].pointNumber)?r:t[l].pointNumbers,r=i._isSimpleKey?i.key:Array.isArray(r)?r.map(function(t){return i.key[t]}):i.key[r],r=i._isNestedKey?[].concat.apply([],r):r,e[i.set].value=e[i.set].value.concat(r))}return e}(t.points);for(e in l)l.hasOwnProperty(e)&&x.set(l[e].value,{sender:n})}};0<o.highlight.debounce&&(P=function(r,i,o){var n;return function(){var t=this,e=arguments,l=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||r.apply(t,e)},i),l&&r.apply(t,e)}}(P,o.highlight.debounce)),a.on(o.highlight.on,P),a.on(o.highlight.off,function(t){C(n),crosstalk.var("plotlySelectionHistory").set(null),x.set(null,{sender:n})}),o.selectize&&(N=Object.keys(o.selectize)[s],P=o.selectize[N].items,d={options:[{value:"",label:"(All)"}].concat(P),searchField:"label",valueField:"value",labelField:"label",maxItems:50},A=$("#"+N).find("select")[0],(E=$(A).selectize(d)[0].selectize).on("change",function(){var e=k.groupSelections[O]||[];if(!o.highlight.persistent){C(n);for(var t=0;t<e.length;t++)E.removeItem(e[t],!0)}var l=E.items.filter(function(t){return e.indexOf(t)<0});0<l.length?k.updateSelection(O,l):(k.updateSelection(O,null),k.updateSelection(O,E.items))}))}}};function D(t,e){this.gd=t,this.origData=JSON.parse(JSON.stringify(t.data)),this.origOpacity=[];for(var l=0;l<this.origData.length;l++)this.origOpacity[l]=0===this.origData[l].opacity?0:this.origData[l].opacity||1;this.groupSelections={},this.highlight=e}function f(t){return t._isNestedKey?o:t._isSimpleKey?i:v}function v(t,l){var r=[];return t.forEach(function(t,e){(null===t||0<=l.indexOf(t))&&r.push(e)}),r}function i(t,e){return t.every(function(t){return null===t||0<=e.indexOf(t)})?[0]:[]}function o(t,e){for(var l=[],r=0;r<t.length;r++)t[r].every(function(t){return null===t||0<=e.indexOf(t)})&&l.push(r);return l}function m(r,i){var o={};return Object.keys(r).forEach(function(t){var e,l=r[t];"_"===t.charAt(0)?o[t]=l:"transforms"===t&&Array.isArray(l)?o[t]=l.map(function(t){return m(t,i)}):"colorscale"===t&&Array.isArray(l)?o[t]=l:(e=l,"[object Object]"===Object.prototype.toString.call(e)&&Object.getPrototypeOf(e)===Object.prototype?o[t]=m(l,i):Array.isArray(l)?o[t]=function(t,e){for(var l=[],r=0;r<e.length;r++)l.push(t[e[r]]);return l}(l,i):o[t]=l)}),o}function C(t){for(var e=t.querySelectorAll(".select-outline"),l=0;l<e.length;l++)e[l].remove()}D.prototype.close=function(){},D.prototype.updateFilter=function(t,e){if(null==e)this.gd.data=JSON.parse(JSON.stringify(this.origData));else for(var l=[],r=0;r<this.origData.length;r++){var i,o=this.origData[r];o.key&&o.set===t&&(0<(i=f(o)(o.key,e)).length&&(o._isSimpleKey||(o=m(o,i)),l.push(o)))}this.gd.data=l,Plotly.redraw(this.gd)},D.prototype.updateSelection=function(c,p){if(null!==p&&!Array.isArray(p))throw new Error("Invalid keys argument; null or array expected");var t=this.gd.data.length-this.origData.length;if(null===p||!this.highlight.persistent&&0<t){for(var e=[],l=0;l<this.gd.data.length;l++)this.gd.data[l]._isCrosstalkTrace&&e.push(l);Plotly.deleteTraces(this.gd,e),this.groupSelections[c]=p}else{this.groupSelections[c]=this.groupSelections[c]||[];for(l=0;l<p.length;l++){var r=p[l];this.groupSelections[c].indexOf(r)<0&&this.groupSelections[c].push(r)}}if(null===p)Plotly.restyle(this.gd,{opacity:this.origOpacity});else if(1<=p.length){for(var g=[],i=crosstalk.group(c).var("plotlySelectionColour").get()||this.highlight.color[0],l=0;l<this.origData.length;l++){var o,d=JSON.parse(JSON.stringify(this.gd.data[l]));d.key&&d.set===c&&0<(h=f(d)(d.key,p)).length&&(d._isSimpleKey||(d=m(d,h)),o=this.gd._fullData[l],$.extend(!0,d,this.highlight.selected),o.marker&&(d.marker=d.marker||{},d.marker.color=i||d.marker.color||o.marker.color),o.line&&(d.line=d.line||{},d.line.color=i||d.line.color||o.line.color),o.textfont&&(d.textfont=d.textfont||{},d.textfont.color=i||d.textfont.color||o.textfont.color),o.fillcolor&&(d.fillcolor=i||d.fillcolor||o.fillcolor),d.name=d.name||p.join("<br />"),d.legendgroup=d.legendgroup||p.join("<br />"),d._originalIndex=l,d._newIndex=this.gd._fullData.length+g.length,d._isCrosstalkTrace=!0,g.push(d))}if(0<g.length){Plotly.addTraces(this.gd,g).then(function(t){for(var e=t._transitionData._frameHash,l=t._transitionData._frames||[],r=0;r<l.length;r++){for(var i=[],o=0;o<g.length;o++){var n=g[o];-1<l[r].traces.indexOf(n._originalIndex)&&(i.push(n._newIndex),l[r].traces.push(n._newIndex))}if(0!==i.length){for(var a=0,s=l[r].data.length,o=0;o<s;o++){var u,h=l[r].data[o];h.key&&h.set===c&&(0<(u=f(h)(h.key,p)).length&&(d._isSimpleKey||(h=m(h,u)),(u=t._fullData[i[a]]).marker&&(h.marker=u.marker),u.line&&(h.line=u.line),u.textfont&&(h.textfont=u.textfont),a+=1,l[r].data.push(h)))}e[l[r].name]=l[r]}}});for(var n=[],a=[],s=Object.keys(this.groupSelections),u=this.origData.length,l=0;l<u;l++){var h,y=this.origOpacity[l]||1;y===this.gd._fullData[l].opacity&&1!==this.highlight.opacityDim&&(h=v(s,[this.gd.data[l].set])).length&&(n.push(l),a.push(y*this.highlight.opacityDim))}0<n.length&&(Plotly.restyle(this.gd,{opacity:a},n),Plotly.restyle(this.gd,{selectedpoints:null}))}}},e.exports=r},{}],2:[function(t,e,l){"use strict";var r,i=t("./plotly.factory"),t=(r=i)&&r.__esModule?r:{default:r};HTMLWidgets.widget(t.default)},{"./plotly.factory":1}]},{},[2]);
//# sourceMappingURL=plotly.js.map
